# apiVersion: v1
# kind: Service
# metadata:
#   name: podinfo
# spec:
#   ports:
#   - name: http
#     port: 9000
#     protocol: TCP
#     targetPort: http
#   clusterIP: None
#   selector:
#     app: podinfo
# ---
# apiVersion: apps/v1
# kind: StatefulSet
# metadata:
#   name: podinfo
# spec:
#   selector:
#     matchLabels:
#       app: podinfo
#   serviceName: podinfo
#   replicas: 0
#   template:
#     metadata:
#       labels:
#         app: podinfo
#     spec:
#       securityContext:
#         fsGroup: 1
#       containers:
#         - name: podinfo
#           image: ghcr.io/stefanprodan/podinfo:6.6.3
#           command:
#             - ./podinfo
#             - '--port=9000'
#           ports:
#             - name: http
#               containerPort: 9000
#               protocol: TCP
#           volumeMounts:
#           - name: data
#             mountPath: /data
#   volumeClaimTemplates:
#   - metadata:
#       name: data
#     spec:
#       accessModes:
#       - ReadWriteOnce
#       storageClassName: yc-network-hdd
#       resources:
#         requests:
#           storage: 1Gi
# ---
# apiVersion: v1
# kind: Pod
# metadata:
#   name: nginx
# spec:
#   containers:
#   - name: nginx
#     image: registry.k8s.io/nginx-slim:0.21
#     ports:
#     - containerPort: 80
#       name: http

# ---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: nginx
spec:
  serviceName: nginx
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        volumeMounts:
        - name: nginx-pvc
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: nginx-pvc
    spec:
      accessModes:
        - ReadWriteOnce
      storageClassName: yc-network-hdd
      resources:
        requests:
          storage: 1Gi
